# CIS 55 – Lecture 3 Notes  
**Topics:** Threat Modeling, Incident Management Exercise, Penetration Testing Tools  

---

## Course Logistics

- **Lab 3 due:** February 14  
- **Quiz 3:** Open from 12pm today until Sunday 12pm  

---

## 1. Threat Modeling

### What Is Threat Modeling?
Threat modeling is the process of assessing security risks of a software system from an adversary’s perspective.  
It focuses on what can go wrong, how it can be exploited, and how to mitigate it.

---

### Goals of Threat Modeling

- Identify threats during requirements analysis  
- Decide which security mechanisms to include during design  
- Verify the security of system architecture  
- Guide secure implementation practices  
- Provide a basis for post-implementation security testing  

---

### Threat Modeling Process

1. Understand the adversary’s view of the system  
2. Characterize system security  
3. Evaluate threats  

This process is iterative and should be revisited as the system changes.

---

### Know Thy Enemy

#### 1. Identify System Assets
Assets are resources an attacker may attempt to access, modify, or steal.

Examples:
- User login data  
- Personal user data  
- Web server resources (CPU, network, disk)  
- Application resources  
- Database server and stored data  
- Organization’s reputation  

---

#### 2. Identify Entry Points
Entry points are locations where data or control transfers into the system.

Examples:
- Network sockets  
- Web forms  
- URLs and parameters  
- File uploads  
- APIs  

Key questions:
- Are there unaccounted backdoor entry points?
- What if the attacker is on the web server?
- What if the attacker is between the web and database servers?
- Can the system distinguish good input from malicious input?
- Can the system detect replay attacks?

---

#### 3. Determine Trust Levels
- Identify trusted external entities  
- Define privilege levels  
- Reduce implicit trust between components  

---

## 2. Characterizing System Security

### Use and Misuse Scenarios
- How do legitimate users use the system?
- How could attackers misuse the same interfaces?

---

### Assumptions and Dependencies
- Which external systems does security depend on?
- What assumptions are made about data or control flow?
- What happens when assumptions fail?

---

### System Modeling
- Model how data flows through the system  
- Track processing from each entry point  
- Use diagrams or modeling tools when possible  

---

## 3. Evaluating Threats

### Identifying Threats
For each entry point:
- Determine how an attacker could affect an asset  
- Predict attacker goals and likely actions  

---

### Analyzing Threats
- Decompose threats into testable conditions  
- Use attack trees for complex attacks  
- Rank threats using a risk model  

---

### DREAD Risk Model

| Category | Question |
|--------|----------|
| Damage | How bad would the attack be? |
| Reproducibility | How easy is it to reproduce? |
| Exploitability | How much effort is required? |
| Affected Users | How many users are impacted? |
| Discoverability | How easy is it to find? |

Each category is scored (1–10), averaged, and used to prioritize mitigation.

---

### Quantifying Threats

- Assign DREAD scores to leaf nodes  
- Propagate values upward in attack trees  
- Alternate approach: monetary cost modeling  
  - Lower cost to attack = higher risk  

---

## 4. Case Study: 2017 Equifax Data Breach

### What Happened
- Vulnerability: CVE-2017-5638 in Apache Struts  
- Patch released but never applied  
- Web portal compromised  
- Poor network segmentation enabled lateral movement  
- Credentials stored in plain text  
- Expired encryption certificate prevented detection  
- Data exfiltration occurred for months  
- Public disclosure delayed  

---

### Key Lessons
- Patch management failures are critical  
- Network segmentation matters  
- Monitoring tools must be maintained  
- Incident response timing affects trust and legal exposure  

---

## 5. Penetration Testing Overview

### Who Needs Pentesting?
- Financial institutions  
- Government organizations  
- Online vendors  
- Any organization handling sensitive data  

Compliance drivers:
- PCI DSS (annual pentesting required)  
- HIPAA Security Rule  
- Security certifications  

---

### Pentesting Viewpoints

- **External vs. Internal**  
  - Internet attacker vs. malicious insider  

- **Overt vs. Covert**  
  - With or without IT’s knowledge  

---

### Phases of Penetration Testing

1. Reconnaissance and information gathering  
2. Network enumeration and scanning  
3. Vulnerability testing and exploitation  
4. Reporting  

---

## 6. Reconnaissance and Enumeration

### Reconnaissance
Goal: Gather information without direct network contact.

Methods:
- WHOIS lookups  
- Search engines  
- Website analysis  

---

### Network Enumeration
Goal: Identify live hosts, open ports, and services.

Methods:
- Scanners (Nmap)  
- DNS queries  
- Traceroute  

---

## 7. Nmap (Network Mapper)

### Purpose
- Discover hosts, ports, services, and OS versions  
- Used for auditing and security profiling  

---

### Common Scan Types

- SYN scan (`-sS`)  
- TCP scan (`-sT`)  
- UDP scan (`-sU`)  
- SCTP scan (`-sY`)  
- Aggressive scan (`-A`)  
- Version detection (`-sV`)  

---

### Scan Speed
- Controlled with `-T0` to `-T5`  
- Faster scans reduce accuracy  

---

### Firewall and IDS Evasion
- Change IP or MAC addresses  
- Use decoys and proxies  
- Vary scan timing  
- Default Nmap scans are often detected  

---

## 8. Vulnerability Testing Tools

### Nessus
- Automated vulnerability scanner  
- Runs 1200+ checks  
- Daily vulnerability updates  
- Provides patching guidance  

---

### Metasploit
- Exploitation framework  
- Access to known exploits  
- Supports scanning, exploitation, and post-exploitation  
- Allows custom exploit development  

Basic workflow:
1. Search for a module  
2. Select the module  
3. Configure options  
4. Run the exploit  

---

## 9. SQL Injection and SQLMap

### SQL Injection
- Inject SQL into input fields or URLs  
- Can bypass authentication or extract data  

Example:
```sql
' OR 1=1 --
```

## SQLMap

Automates SQL injection exploitation.

### Capabilities
- Detect injection points  
- Enumerate databases and tables  
- Dump data  
- Crack password hashes  

### Common Options
- `-u` scan URL  
- `-dbs` enumerate databases  
- `-tables` list tables  
- `-dump` extract data  

---

## 10. Reporting

### Purpose
- Clearly document findings  
- Organize risks by host and service  
- Provide actionable remediation guidance  

### Tools
- Dradis  
- Structured reports  

---

## 11. Becoming a Penetration Tester

- Stay current with security research  
- Learn scripting (Python recommended)  

### Certifications
- CEH  
- eJPT  
- GPEN  
- CompTIA Pentest+  
- OSCP  

---

## 12. Personal Security Basics

- Use a password manager  
- Enable Do Not Track  
- Practice phishing awareness  

---

## Reminders

- **Lab 3 due:  **
- **Quiz 3 closes:** 


